<html>
  <head>
    <link rel="stylesheet" href="style.css">
    <title>Some obs stuff</title>
  </head>
  <body>
    <p id="wsinfo">
        Для того чтобы пользоваться этим "инструментом" нужно включить WebSocket 
        в настройках OBS. Для версии 28 и выше: в самом OBS нажать<br>Сервис > 
        Настройки obs-websocket > Включить сервер WebSocket. Там же брать Порт и Пароль.
        <span onclick="window.open('https://i.imgur.com/OEK8OBj.png','_blank')"
         >ПРИМЕР</span> <br><br> Важно в источнике браузера в OBS также выставить Продвинутый или Полный доступ.
        <span onclick="window.open('https://i.imgur.com/htSumiB.png','_blank')"
           >ПРИМЕР</span> <br><br>
        Команды для модеров: !vodmute и !vodunmute
    </p>

    <div class="row">
      <p>Twitch Канал</p>
      <input type="text" id="channel" placeholder="twitch.tv/канал" required>
    </div>

    <div class="row">
      <p>Порт от WebSocket</p>
      <input type="text" id="port" value="4455" placeholder="4455" required>
    </div>

    <div class="row">
      <p>Пароль от WebSocket</p>
      <input type="password" id="password" placeholder="аутентификация отключена">
    </div>

    <div class="row">
      <p>Название аудио источника</p>
      <input type="text" id="audio" placeholder="Звук раб. стола" value="Звук раб. стола" required>
    </div>

    <div class="row">
      <p>Номер нужной дорожки</p>
      <input type="number" id="track" min="1" max="6" value="2" required>
    </div>

    <button id="copy" onclick="copy_url()">
      Скопировать ссылку для OBS
    </button>

    <script>
      function copy_url() {
        let channel = document.getElementById("channel").value
        let port = document.getElementById("port").value
        let password = document.getElementById("password").value
        let audio = document.getElementById("audio").value
        let track = document.getElementById("track").value

        let text = "https://declider.github.io/somestuff/vodmute/widget.html?"

        if (channel !== "") {
          text += "channel="+channel+"&"
        }

        if (port !== "") {
          text += "port="+port+"&"
        }

        if (password !== "") {
          text += "password="+password+"&"
        }

        if (audio !== "") {
          text += "audio="+encodeURIComponent(audio)+"&"
        }

        if (track !== "") {
          text += "track="+track+"&"
        }

        navigator.clipboard.writeText(text.slice(0, -1))

        alert("Ссылка для OBS скопирована!")
      }
    </script>
    
  </body>
</html>
